<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - {{TEST_TYPE}}</title>
    <script src="http://code.jquery.com/jquery.min.js"></script>
    <script src="http://code.jquery.com/jquery-3.6.0.js"></script>
    <script src="http://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <div id="blackout"></div>
    <div class="body-wrapper">
        <span class="title">Departamentul Medical FPlayT</span>
        <div class="test-wrapper">
            <span class="header" id="testType"></span>
            <div class="test-stats">
                <span>Întrebarea <span class="gradient question-index">01/16</span></span>
                <span>Timp rămas: <span class="gradient" id="timp">0m 0s</span></span>
                <span>Greșeli: <span class="gradient mistakes-count">0/3</span></span>
            </div>
            <span class="question">Ce medicament administrezi unui pacient aflat în stare de anemie?</span>
            <div class="test-options">
            </div>
            <div class="test-buttons">
                <div class="button send-answer">
                    <span>TRIMITE RĂSPUNSUL</span>
                </div>
                <div class="button answer-later">
                    <span>RĂSPUND MAI TÂRZIU</span>
                </div>
                <div class="button clear-answer">
                    <span>ȘTERGE RĂSPUNSUL</span>
                </div>
            </div>
        </div>
        <div class="test-result" style="display:none;">
            <span></span>
            <div class="button" onclick="redirectMain()">
                <span>PAGINA PRINCIPALĂ</span>
            </div>
        </div>
    </div>
</body>

<script src="/script.js"></script>
<script>
    const testType = "{{TEST_TYPE}}"
    const code = "{{TEST_CODE}}"
    const discordId = "{{TEST_NAME}}"
    const name = "{{TEST_DISCORD}}"
    const testType2 = "{{TEST_TYPE2}}"
    document.getElementById("testType").innerHTML = `Test ${testType2}`;
    function redirectMain() {
        window.location.href = `/main?name=${encodeURIComponent(name)}&id=${encodeURIComponent(discordId)}`;
    }

    window.onbeforeunload = function (e) {
    const message = "Your confirmation message goes here.";
    e = e || window.event;

    if (e) {
        e.returnValue = message;
    }

    // Discord webhook URL
    const discordWebhook = 'https://discordapp.com/api/webhooks/1313459120266805248/-Qua05_SGaw2-P2nZPvvz8iy2FyXlDTqWh8SYe6L6YYzxOFEfL9CdhB0jWJUbFGRcLgM';

    // The embed object
    const embed = {
        title: "INCERCARE LEAVE/REFRESH",
        description: `<@${discordId}> a incercat sa iasa din test sau sa dea refersh la pagina.`,
        color: 0xff0000, // Red color
        timestamp: new Date().toISOString(), // Current timestamp
    };

    // The payload
    const payload = {
        embeds: [embed]
    };

    // Send the webhook
    fetch(discordWebhook, {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(payload)
    }).catch(error => {
        console.error("Failed to send Discord webhook:", error);
    });

    return message;
};

//function checkResize() {
  //const width = window.innerWidth;
  //const height = window.innerHeight;

  //const isFullscreenMonitor = width >= 1920 && height >= 1080;
  //const isPhone = width <= 768 && height <= 1024; // Typical phone breakpoints

  //const blackoutElement = document.getElementById("blackout");

  //if ((isFullscreenMonitor || isPhone) && document.hasFocus()) {
    //blackoutElement.style.display = "none";
  //} else {
   // blackoutElement.style.display = "block";
  //}
//}

//setTimeout(() => {
//  checkResize();
//}, 1000);

//window.addEventListener('resize', checkResize);
//window.addEventListener('focus', checkResize);
//window.addEventListener('blur', checkResize);

</script>
</html>
